<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RationSmart Tests - Registration</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=IBM+Plex+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <link rel="stylesheet" href="../shared.css">
</head>
<body>
    <nav class="sidebar">
        <div class="sidebar-brand"><i data-lucide="beef" class="icon"></i> RationSmart</div>
        <div class="sidebar-subtitle">Test Cases &middot; 14 Pages</div>
        <h3>Overview</h3>
        <a href="index.html"><span class="nav-num">00</span> Overview &amp; Glossary</a>
        <h3>Authentication</h3>
        <a href="registration.html" class="active"><span class="nav-num">01</span> Registration (8)</a>
        <a href="login.html"><span class="nav-num">02</span> Login (10)</a>
        <a href="forgot-pin.html"><span class="nav-num">03</span> Forgot PIN (5)</a>
        <a href="onboarding.html"><span class="nav-num">04</span> Onboarding (12)</a>
        <h3>Core Features</h3>
        <a href="dashboard.html"><span class="nav-num">05</span> Dashboard (8)</a>
        <a href="cow-management.html"><span class="nav-num">06</span> Cow Management (13)</a>
        <a href="diet-optimization.html"><span class="nav-num">07</span> Diet Optimization (17)</a>
        <a href="feeds.html"><span class="nav-num">08</span> Feeds (7)</a>
        <a href="milk-logging.html"><span class="nav-num">09</span> Milk Logging (8)</a>
        <a href="farmer-management.html"><span class="nav-num">10</span> Farmer Mgmt (10)</a>
        <a href="yield-reporting.html"><span class="nav-num">11</span> Yield Reporting (7)</a>
        <h3>Settings &amp; Platform</h3>
        <a href="settings.html"><span class="nav-num">12</span> Settings (10)</a>
        <a href="navigation-pwa.html"><span class="nav-num">13</span> Navigation &amp; PWA (12)</a>
    </nav>
    <main class="main">

        <div class="page-title">01 &mdash; Registration Test Cases</div>
        <div class="page-route">Module: Registration &middot; Route: /auth/register &middot; 8 Test Cases</div>

        <!-- ════════════════════════════════════════════════════ -->
        <!-- TC-REG-01 -->
        <!-- ════════════════════════════════════════════════════ -->
        <div class="tc critical">
            <div class="tc-header">
                <span class="tc-id">TC-REG-01</span>
                <span class="tc-title">Register with Email &mdash; Happy Path</span>
                <span class="tc-priority">Critical</span>
            </div>
            <div class="tc-body">
                <h4>Preconditions</h4>
                <div class="tc-pre">
                    No existing account with the test email. The app is open and displaying the registration page at <strong>/auth/register</strong>.
                </div>

                <h4>Steps</h4>
                <ol class="tc-steps">
                    <li>Locate the <strong>Full Name</strong> text field at the top of the form and enter <code>Test User</code>.</li>
                    <li>Verify the <strong>Email</strong> toggle button is already selected (highlighted/active). If not, tap it to switch to email mode. The toggle is a two-option switch that lets you choose between registering with an email address or a phone number.</li>
                    <li>Enter <code>testuser@example.com</code> in the <strong>Email</strong> input field.</li>
                    <li>Tap the <strong>Country</strong> dropdown and select <strong>India (+91)</strong>. After selection, confirm a small flag image appears next to the country name in the dropdown display.</li>
                    <li>Enter <code>1234</code> in the <strong>Create PIN</strong> field. As you type each digit, verify that dots (or asterisks) appear instead of the actual numbers. A PIN is a 4-digit numeric password used to log in quickly.</li>
                    <li>Enter <code>1234</code> in the <strong>Confirm PIN</strong> field. Again, verify that dots/asterisks appear instead of digits.</li>
                    <li>Tap the <strong>Register</strong> button at the bottom of the form.</li>
                </ol>

                <h4>Expected Result</h4>
                <div class="tc-expected">
                    The account is created successfully. The app automatically redirects the user to the <strong>Language Selection</strong> page at <code>/auth/language</code>. This is the first step of the onboarding flow that new users go through after registering.
                </div>

                <h4>Acceptance Criteria</h4>
                <ul class="tc-checks">
                    <li>Registration form submits without errors</li>
                    <li>User is redirected to <code>/auth/language</code> (first onboarding step)</li>
                    <li>No error banners or toast messages are displayed</li>
                    <li>PIN fields show dots/asterisks at all times (not the actual numbers)</li>
                </ul>
            </div>
        </div>

        <!-- ════════════════════════════════════════════════════ -->
        <!-- TC-REG-02 -->
        <!-- ════════════════════════════════════════════════════ -->
        <div class="tc critical">
            <div class="tc-header">
                <span class="tc-id">TC-REG-02</span>
                <span class="tc-title">Register with Phone Number &mdash; Happy Path</span>
                <span class="tc-priority">Critical</span>
            </div>
            <div class="tc-body">
                <h4>Preconditions</h4>
                <div class="tc-pre">
                    No existing account with the test phone number. The app is open at <strong>/auth/register</strong>.
                </div>

                <h4>Steps</h4>
                <ol class="tc-steps">
                    <li>Enter <code>Phone User</code> in the <strong>Full Name</strong> field.</li>
                    <li>Tap the <strong>Phone</strong> toggle button. It should become highlighted/active, and the form should switch from showing an email input to showing a phone number input. The toggle is a two-option switch at the top of the form.</li>
                    <li>Verify the <strong>Country</strong> dropdown appears and shows <strong>India (+91)</strong> by default, with a small flag image next to the country name.</li>
                    <li>Enter <code>9876543210</code> in the phone number field. Confirm that a small Indian flag icon and the text <strong>+91</strong> appear as a prefix before the input area. The <code>+91</code> is India's international dialing code.</li>
                    <li>Enter <code>5678</code> in the <strong>Create PIN</strong> field.</li>
                    <li>Enter <code>5678</code> in the <strong>Confirm PIN</strong> field.</li>
                    <li>Tap the <strong>Register</strong> button.</li>
                </ol>

                <h4>Expected Result</h4>
                <div class="tc-expected">
                    The account is created successfully. The app redirects the user to <code>/auth/language</code>, the Language Selection page (first step of onboarding).
                </div>

                <h4>Acceptance Criteria</h4>
                <ul class="tc-checks">
                    <li>Phone toggle switches the input mode from email to phone number</li>
                    <li>Country dropdown displays a flag image + country name + dial code (e.g., "India (+91)")</li>
                    <li>Phone input shows a flag icon + "+91" prefix before the number entry area</li>
                    <li>Phone number field accepts exactly 10 digits for India (no more, no less)</li>
                    <li>After successful registration, user is redirected to the onboarding flow</li>
                </ul>
            </div>
        </div>

        <!-- ════════════════════════════════════════════════════ -->
        <!-- TC-REG-03 -->
        <!-- ════════════════════════════════════════════════════ -->
        <div class="tc high">
            <div class="tc-header">
                <span class="tc-id">TC-REG-03</span>
                <span class="tc-title">PIN Mismatch Shows Validation Error</span>
                <span class="tc-priority">High</span>
            </div>
            <div class="tc-body">
                <h4>Preconditions</h4>
                <div class="tc-pre">
                    The app is open at <strong>/auth/register</strong>. No special setup needed.
                </div>

                <h4>Steps</h4>
                <ol class="tc-steps">
                    <li>Enter <code>Mismatch Test</code> in the <strong>Full Name</strong> field.</li>
                    <li>Enter <code>mismatch@test.com</code> in the <strong>Email</strong> field (ensure the Email toggle is active).</li>
                    <li>Select any country from the Country dropdown.</li>
                    <li>Enter <code>1234</code> in the <strong>Create PIN</strong> field.</li>
                    <li>Enter <code>5678</code> in the <strong>Confirm PIN</strong> field. This is deliberately different from the Create PIN to trigger a mismatch error.</li>
                    <li>Tap the <strong>Register</strong> button.</li>
                </ol>

                <h4>Expected Result</h4>
                <div class="tc-expected">
                    The form does <strong>not</strong> submit. A validation error message appears near the Confirm PIN field indicating that the two PINs do not match (e.g., "PINs do not match" or similar wording). The user remains on the registration page.
                </div>

                <h4>Acceptance Criteria</h4>
                <ul class="tc-checks">
                    <li>Form validation triggers on the client side before any API call is made</li>
                    <li>Error text is visible near the Confirm PIN field</li>
                    <li>The Register button does not show a loading spinner (no network request was attempted)</li>
                    <li>User remains on the registration page (<code>/auth/register</code>)</li>
                </ul>
            </div>
        </div>

        <!-- ════════════════════════════════════════════════════ -->
        <!-- TC-REG-04 -->
        <!-- ════════════════════════════════════════════════════ -->
        <div class="tc high">
            <div class="tc-header">
                <span class="tc-id">TC-REG-04</span>
                <span class="tc-title">Duplicate Email Registration Rejected</span>
                <span class="tc-priority">High</span>
            </div>
            <div class="tc-body">
                <h4>Preconditions</h4>
                <div class="tc-pre">
                    An account with the email <code>existing@test.com</code> has already been registered in the system. The app is open at <strong>/auth/register</strong>.
                </div>

                <h4>Steps</h4>
                <ol class="tc-steps">
                    <li>Enter <code>Duplicate Test</code> in the <strong>Full Name</strong> field.</li>
                    <li>Enter <code>existing@test.com</code> in the <strong>Email</strong> field (this email is already in use by another account).</li>
                    <li>Select any country from the Country dropdown.</li>
                    <li>Enter <code>1234</code> in the <strong>Create PIN</strong> field.</li>
                    <li>Enter <code>1234</code> in the <strong>Confirm PIN</strong> field.</li>
                    <li>Tap the <strong>Register</strong> button.</li>
                </ol>

                <h4>Expected Result</h4>
                <div class="tc-expected">
                    An error banner or message is displayed informing the user that an account with this email already exists (or similar wording). The user stays on the registration page and is not redirected.
                </div>

                <h4>Acceptance Criteria</h4>
                <ul class="tc-checks">
                    <li>The API returns an error response (HTTP 409 Conflict or 422 Unprocessable Entity)</li>
                    <li>An error message is displayed to the user on screen</li>
                    <li>The form remains filled with the user's input (the user does not lose what they typed)</li>
                    <li>No redirect occurs &mdash; the URL stays at <code>/auth/register</code></li>
                </ul>
            </div>
        </div>

        <!-- ════════════════════════════════════════════════════ -->
        <!-- TC-REG-05 -->
        <!-- ════════════════════════════════════════════════════ -->
        <div class="tc medium">
            <div class="tc-header">
                <span class="tc-id">TC-REG-05</span>
                <span class="tc-title">Country Selector Shows Flag Icons and Dial Codes</span>
                <span class="tc-priority">Medium</span>
            </div>
            <div class="tc-body">
                <h4>Preconditions</h4>
                <div class="tc-pre">
                    The app is open at <strong>/auth/register</strong>. The <strong>Phone</strong> toggle is active (tapped) so the phone number input and country dropdown are visible.
                </div>

                <h4>Steps</h4>
                <ol class="tc-steps">
                    <li>Tap the <strong>Phone</strong> toggle if it is not already active. This switches the form from email registration to phone registration and reveals the country selector.</li>
                    <li>Tap the <strong>Country</strong> dropdown to open the list of available countries.</li>
                    <li>Scroll through the country list. For each country, observe whether it displays: (a) a small flag image, (b) the country name, and (c) the dial code in parentheses (e.g., "+91", "+254").</li>
                    <li>Select <strong>Kenya (+254)</strong> from the list. Kenya is an East African country; its dial code is +254.</li>
                </ol>

                <h4>Expected Result</h4>
                <div class="tc-expected">
                    The dropdown shows each country entry with three components: a small flag <strong>image</strong> (not a Unicode emoji character), the country name in text, and the dial code in parentheses. After selecting Kenya, the phone input prefix changes to display the Kenya flag image and the text <strong>+254</strong>.
                </div>

                <h4>Acceptance Criteria</h4>
                <ul class="tc-checks">
                    <li>Flag images load correctly for all countries (no broken image icons or missing placeholders)</li>
                    <li>Each country entry shows the dial code in parentheses (e.g., "+91", "+254", "+251")</li>
                    <li>Flags are rendered as actual images (e.g., <code>&lt;img&gt;</code> tags), not Unicode flag emoji text characters</li>
                    <li>After selecting Kenya, the phone input prefix updates to show the Kenya flag + "+254"</li>
                </ul>
            </div>
        </div>

        <!-- ════════════════════════════════════════════════════ -->
        <!-- TC-REG-06 -->
        <!-- ════════════════════════════════════════════════════ -->
        <div class="tc medium">
            <div class="tc-header">
                <span class="tc-id">TC-REG-06</span>
                <span class="tc-title">Phone Input Mask Changes Per Country</span>
                <span class="tc-priority">Medium</span>
            </div>
            <div class="tc-body">
                <h4>Preconditions</h4>
                <div class="tc-pre">
                    The app is open at <strong>/auth/register</strong>. The <strong>Phone</strong> toggle is active. The phone number input and country dropdown are visible.
                </div>

                <h4>Steps</h4>
                <ol class="tc-steps">
                    <li>Select <strong>India (+91)</strong> from the Country dropdown. Enter a phone number and verify the input accepts exactly <strong>10 digits</strong>. Try typing an 11th digit and confirm it is blocked or ignored.</li>
                    <li>Clear the phone number field. Change the country to <strong>Kenya (+254)</strong>. Enter a phone number and verify the input accepts exactly <strong>9 digits</strong>.</li>
                    <li>Clear the phone number field. Change the country to <strong>Bangladesh (+880)</strong>. Enter a phone number and verify the input accepts exactly <strong>11 digits</strong>. Bangladesh is a South Asian country with longer phone numbers than most.</li>
                    <li>Clear the phone number field. Change the country to <strong>Ethiopia (+251)</strong>. Enter a phone number and verify the input accepts exactly <strong>9 digits</strong>. Ethiopia is an East African country.</li>
                    <li>Clear the phone number field. Change the country to <strong>Nepal (+977)</strong>. Enter a phone number and verify the input accepts exactly <strong>10 digits</strong>. Nepal is a South Asian country bordering India.</li>
                    <li>Clear the phone number field. Change the country to <strong>Vietnam (+84)</strong>. Enter a phone number and verify the input accepts exactly <strong>9 digits</strong>. Vietnam is a Southeast Asian country.</li>
                </ol>

                <h4>Expected Result</h4>
                <div class="tc-expected">
                    The phone input mask (the maximum number of digits the field will accept) adapts dynamically each time a different country is selected. The digit limit changes to match the selected country's phone number format.
                </div>

                <h4>Acceptance Criteria</h4>
                <ul class="tc-checks">
                    <li>India: accepts exactly 10 digits, blocks further input after 10</li>
                    <li>Kenya: accepts exactly 9 digits</li>
                    <li>Ethiopia: accepts exactly 9 digits</li>
                    <li>Nepal: accepts exactly 10 digits</li>
                    <li>Bangladesh: accepts exactly 11 digits</li>
                    <li>Vietnam: accepts exactly 9 digits</li>
                </ul>
            </div>
        </div>

        <!-- ════════════════════════════════════════════════════ -->
        <!-- TC-REG-07 -->
        <!-- ════════════════════════════════════════════════════ -->
        <div class="tc high">
            <div class="tc-header">
                <span class="tc-id">TC-REG-07</span>
                <span class="tc-title">Required Field Validations</span>
                <span class="tc-priority">High</span>
            </div>
            <div class="tc-body">
                <h4>Preconditions</h4>
                <div class="tc-pre">
                    The app is open at <strong>/auth/register</strong>. All form fields are empty (fresh page load or cleared form).
                </div>

                <h4>Steps</h4>
                <ol class="tc-steps">
                    <li>Without filling in any fields, tap the <strong>Register</strong> button. Observe which fields show validation error messages.</li>
                    <li>Fill in only the <strong>Full Name</strong> field with <code>Validation Test</code>. Leave the Email, Create PIN, and Confirm PIN fields empty. Tap <strong>Register</strong>. Observe the validation errors.</li>
                    <li>Now also fill in the <strong>Email</strong> field with <code>valid@test.com</code>. Leave both PIN fields empty. Tap <strong>Register</strong>. Observe the validation errors.</li>
                    <li>Now fill in the <strong>Create PIN</strong> field with <code>1234</code> but leave the <strong>Confirm PIN</strong> field empty. Tap <strong>Register</strong>. Observe the validation error.</li>
                    <li>Finally, fill in the <strong>Confirm PIN</strong> field with <code>1234</code> (matching the Create PIN). Verify that all previous validation errors have disappeared now that every field is correctly filled.</li>
                </ol>

                <h4>Expected Result</h4>
                <div class="tc-expected">
                    Each required field displays its own validation error message when left empty. The form refuses to submit until every required field has a valid value. As the user fills in each field correctly, the corresponding error message disappears.
                </div>

                <h4>Acceptance Criteria</h4>
                <ul class="tc-checks">
                    <li>Name field shows a "Required" (or similar) error when empty</li>
                    <li>Email field shows a "Required" or "Invalid email" error when empty</li>
                    <li>PIN fields show validation errors when empty</li>
                    <li>The form does not submit while any required field is missing a value</li>
                    <li>Error messages disappear individually as each field is correctly filled in</li>
                </ul>
            </div>
        </div>

        <!-- ════════════════════════════════════════════════════ -->
        <!-- TC-REG-08 -->
        <!-- ════════════════════════════════════════════════════ -->
        <div class="tc critical">
            <div class="tc-header">
                <span class="tc-id">TC-REG-08</span>
                <span class="tc-title">Successful Registration Redirects to Onboarding</span>
                <span class="tc-priority">Critical</span>
            </div>
            <div class="tc-body">
                <h4>Preconditions</h4>
                <div class="tc-pre">
                    A valid, unused email or phone number is available for registration. The app is open at <strong>/auth/register</strong>. Browser developer tools are open to the <strong>Network</strong> tab so you can inspect HTTP requests.
                </div>

                <h4>Steps</h4>
                <ol class="tc-steps">
                    <li>Complete a valid registration using either the email or phone method (refer to TC-REG-01 or TC-REG-02 for the full steps). Use credentials that have not been registered before.</li>
                    <li>After tapping <strong>Register</strong>, watch the browser's address bar. Observe the URL change.</li>
                    <li>Verify the URL changes to <code>/auth/language</code>. This is the Language Selection page, which is the first step in the onboarding flow. Onboarding is a multi-step setup process that new users complete after registering (selecting language, role, etc.).</li>
                    <li>Verify the Language Selection page fully loads and displays its content. Look for a step indicator showing <strong>"Step 1 of 4"</strong> (or similar progress text).</li>
                    <li>In the browser developer tools Network tab, inspect the HTTP requests made after registration. Look for an authentication token (e.g., a JWT or session cookie) being included in the headers of requests made after the redirect. This confirms the user is automatically logged in.</li>
                </ol>

                <h4>Expected Result</h4>
                <div class="tc-expected">
                    After successful registration, the user is automatically authenticated (logged in) and immediately redirected to the first onboarding step &mdash; the Language Selection page at <code>/auth/language</code>. There are no intermediate screens between registration and onboarding. The user does not need to log in separately.
                </div>

                <h4>Acceptance Criteria</h4>
                <ul class="tc-checks">
                    <li>No intermediate pages are shown between registration and the onboarding flow</li>
                    <li>The URL is <code>/auth/language</code> after the redirect</li>
                    <li>The Language Selection page displays a step indicator such as "Step 1 of 4"</li>
                    <li>The user does not need to log in separately after registering</li>
                    <li>The Network tab confirms an auth token is present in subsequent HTTP request headers</li>
                </ul>
            </div>
        </div>

    </main>
    <script>lucide.createIcons();</script>
</body>
</html>
